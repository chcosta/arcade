parameters:
  variables: {}
  phase: {}

phases:
- phase: ${{ parameters.phase.agentOs }}
  ${{ if eq(parameters.phase.agentOs, 'Windows_NT') }}:
    # Windows variables
    variables:
      scriptExtension: cmd
      engCommonDirectory: eng\common\
      ${{ insert }}: ${{ parameters.phase.variables }}
  # Linux variables
  ${{ if not(eq(parameters.phase. agentOs, 'Windows_NT')) }}:
    variables:
      scriptExtension: sh
      engCommonDirectory: eng/common/
      ${{ insert }}: ${{ parameters.phase.variables }}
      queue: ${{ parameters.phase.queue }}
      steps:
        - template: /eng/common/vsts-templates/steps/internal.yml
          parameters:
            OfficialBuildId: ''
            steps: ${{ parameters.phase.steps }}